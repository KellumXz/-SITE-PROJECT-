<!DOCTYPE html>
<html>
<head>
  <title>Deploy Repo (Client JS only)</title>
</head>
<body>
  <h3>Deploy Clicker-X-MD</h3>
  <input id="name" placeholder="Your name"><br>
  <input id="token" placeholder="GitHub token"><br>
  <button onclick="deploy()">Deploy</button>
  <pre id="output"></pre>

<script>
async function deploy() {
  const name = document.getElementById("name").value;
  const token = document.getElementById("token").value;
  const output = document.getElementById("output");

  const headers = {
    Authorization: `token ${token}`,
    Accept: 'application/vnd.github+json'
  };

  try {
    // Get username
    const userRes = await fetch("https://api.github.com/user", { headers });
    const user = await userRes.json();
    const username = user.login;
    output.textContent = `Logged in as ${username}...\n`;

    // Fork repo
    await fetch("https://api.github.com/repos/Kx-Shrii/CLICKER-X-MD/forks", {
      method: "POST",
      headers
    });
    output.textContent += "Forked repository...\n";

    // Star repo
    await fetch("https://api.github.com/user/starred/Kx-Shrii/CLICKER-X-MD", {
      method: "PUT",
      headers
    });
    output.textContent += "Starred repository...\n";

    // Create config.js content
    const config = `module.exports = {
  name: "${name}",
  github: "${username}",
  token: "${token}"
};`;
    const content = btoa(config);

    // Push config.js to forked repo
    await fetch(`https://api.github.com/repos/${username}/CLICKER-X-MD/contents/config.js`, {
      method: "PUT",
      headers,
      body: JSON.stringify({
        message: "Add config.js",
        content: content
      })
    });

    output.textContent += "config.js uploaded!\n";

    // Done
    output.textContent += "Done! Check your repo.";
  } catch (err) {
    console.error(err);
    output.textContent += "Error: " + err.message;
  }
}
</script>
</body>
</html>
